

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to Choose Parameters in tmap &mdash; tmap 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualizing and Exploring TDA Network" href="vis.html" />
    <link rel="prev" title="Basic Usage of tmap" href="basic.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> tmap
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic Usage of <em>tmap</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to Choose Parameters in <em>tmap</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#selecting-components-in-filter">Selecting <code class="docutils literal notranslate"><span class="pre">components</span></code> in <code class="docutils literal notranslate"><span class="pre">filter</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-resolution-and-overlap-in-cover">Selecting <code class="docutils literal notranslate"><span class="pre">resolution</span></code> and <code class="docutils literal notranslate"><span class="pre">overlap</span></code> in <code class="docutils literal notranslate"><span class="pre">Cover</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-eps-and-min-samples-in-dbscan">Selecting <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> in DBSCAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimization-of-a-cover-ratio-of-samples">Optimization of a <em>cover ratio</em> of Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#relationship-between-cover-ratio-and-tmap-parameters">Relationship between <em>cover ratio</em> and <em>tmap</em> parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vis.html">Visualizing and Exploring TDA Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="statistical.html">Network Statistical Analysis in <em>tmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="how2work.html">How <em>tmap</em> work</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Microbiome Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tmap</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>How to Choose Parameters in <em>tmap</em></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/param.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="how-to-choose-parameters-in-tmap">
<h1>How to Choose Parameters in <em>tmap</em><a class="headerlink" href="#how-to-choose-parameters-in-tmap" title="Permalink to this headline">¶</a></h1>
<p><em>tmap</em> consists of several steps of data analysis, from projection to TDA network construction. The choice of different parameters for each step influences the final TDA network. Given different dataset and the underlying study questions, these parameters should be set up carefully. We will demonstrate how these parameters would affect the final result and how to choose them properly in this tutorial.</p>
<div class="section" id="selecting-components-in-filter">
<h2>Selecting <code class="docutils literal notranslate"><span class="pre">components</span></code> in <code class="docutils literal notranslate"><span class="pre">filter</span></code><a class="headerlink" href="#selecting-components-in-filter" title="Permalink to this headline">¶</a></h2>
<p>Projection of original data points onto a low dimensional representation is the first step of <em>tmap</em>, and it is important to set up the <code class="docutils literal notranslate"><span class="pre">filter</span></code> and <code class="docutils literal notranslate"><span class="pre">components</span></code> properly. If we go to the details of the algorithm in <a class="reference internal" href="how2work.html"><span class="doc">How tmap work</span></a>, we can see that increasing the number of components of a filter will exponentially increase the time of computation and also the number of edges/nodes.
Usually, different filters, such as PCA and t-SNE, project the data in different ways, and will give different TDA results. In our experience, we can try different filters (PCA, MDS, t-SNE), and choose the suitable one, and most of the time, we use two components for each filter.</p>
<p>In the following code, we compare the effects of choosing different components for <em>tmap</em> analysis, using the iris dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>
<span class="kn">from</span> <span class="nn">tmap.tda</span> <span class="kn">import</span> <span class="n">mapper</span><span class="p">,</span> <span class="nb">filter</span>
<span class="kn">from</span> <span class="nn">tmap.tda.cover</span> <span class="kn">import</span> <span class="n">Cover</span>
<span class="kn">from</span> <span class="nn">tmap.tda.plot</span> <span class="kn">import</span> <span class="n">show</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span><span class="n">vis_progressX</span>


<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># Step1. initiate a Mapper</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">Mapper</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Step2. Projection</span>
<span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">filter</span><span class="o">.</span><span class="n">MDS</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span><span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">projected_X</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">lens</span><span class="o">=</span><span class="n">lens</span><span class="p">)</span>

<span class="c1"># Step3. Covering, clustering &amp; mapping</span>
<span class="n">clusterer</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cover</span> <span class="o">=</span> <span class="n">Cover</span><span class="p">(</span><span class="n">projected_data</span><span class="o">=</span><span class="n">MinMaxScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">projected_X</span><span class="p">),</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">cover</span><span class="o">=</span><span class="n">cover</span><span class="p">,</span> <span class="n">clusterer</span><span class="o">=</span><span class="n">clusterer</span><span class="p">)</span>

<span class="n">vis_progressX</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;_static/comp1.html&#39;</span><span class="p">)</span>
<span class="c1">#show(data=X,graph=graph, color=&#39;b&#39;, fig_size=(10, 10), node_size=15, mode=&#39;spring&#39;, strength=0.15)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Filtering</span> <span class="n">by</span> <span class="n">MDS</span><span class="o">.</span>
<span class="o">...</span><span class="n">calculate</span> <span class="n">distance</span> <span class="n">matrix</span> <span class="n">using</span> <span class="n">the</span> <span class="n">euclidean</span> <span class="n">metric</span><span class="o">.</span>
<span class="n">Finish</span> <span class="n">filtering</span> <span class="n">of</span> <span class="n">points</span> <span class="n">cloud</span> <span class="n">data</span><span class="o">.</span>
<span class="n">Mapping</span> <span class="n">on</span> <span class="n">data</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="n">using</span> <span class="n">lens</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">...</span><span class="n">minimal</span> <span class="n">number</span> <span class="n">of</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">hypercube</span> <span class="n">to</span> <span class="n">do</span> <span class="n">clustering</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">...</span><span class="n">create</span> <span class="mi">219</span> <span class="n">nodes</span><span class="o">.</span>
<span class="o">...</span><span class="n">calculate</span> <span class="n">projection</span> <span class="n">coordinates</span> <span class="n">of</span> <span class="n">nodes</span><span class="o">.</span>
<span class="o">...</span><span class="n">construct</span> <span class="n">a</span> <span class="n">TDA</span> <span class="n">graph</span><span class="o">.</span>
<span class="o">...</span><span class="n">create</span> <span class="mi">1133</span> <span class="n">edges</span><span class="o">.</span>
<span class="n">Finish</span> <span class="n">TDA</span> <span class="n">mapping</span>
</pre></div>
</div>
<iframe src="_static/comp1.html" height="500px" width="100%"></iframe><p>Using two components of MDS as <em>lens</em>, <em>tmap</em> generates a graph with 219 nodes and 1133 edges.
<em>Note: component index is 0-based, and the first component is indexed by 0</em>.</p>
<p>What if we choose three components of MDS?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>
<span class="kn">from</span> <span class="nn">tmap.tda</span> <span class="kn">import</span> <span class="n">mapper</span><span class="p">,</span> <span class="nb">filter</span>
<span class="kn">from</span> <span class="nn">tmap.tda.cover</span> <span class="kn">import</span> <span class="n">Cover</span>
<span class="kn">from</span> <span class="nn">tmap.tda.plot</span> <span class="kn">import</span> <span class="n">show</span><span class="p">,</span><span class="n">vis_progressX</span><span class="p">,</span><span class="n">Color</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># Step1. initiate a Mapper</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">Mapper</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Step2. Projection</span>
<span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">filter</span><span class="o">.</span><span class="n">MDS</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span><span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">projected_X</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">lens</span><span class="o">=</span><span class="n">lens</span><span class="p">)</span>

<span class="c1"># Step3. Covering, clustering &amp; mapping</span>
<span class="n">clusterer</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cover</span> <span class="o">=</span> <span class="n">Cover</span><span class="p">(</span><span class="n">projected_data</span><span class="o">=</span><span class="n">MinMaxScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">projected_X</span><span class="p">),</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">cover</span><span class="o">=</span><span class="n">cover</span><span class="p">,</span> <span class="n">clusterer</span><span class="o">=</span><span class="n">clusterer</span><span class="p">)</span>

<span class="n">vis_progressX</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;_static/comp2.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Filtering</span> <span class="n">by</span> <span class="n">MDS</span><span class="o">.</span>
<span class="o">...</span><span class="n">calculate</span> <span class="n">distance</span> <span class="n">matrix</span> <span class="n">using</span> <span class="n">the</span> <span class="n">euclidean</span> <span class="n">metric</span><span class="o">.</span>
<span class="n">Finish</span> <span class="n">filtering</span> <span class="n">of</span> <span class="n">points</span> <span class="n">cloud</span> <span class="n">data</span><span class="o">.</span>
<span class="n">Mapping</span> <span class="n">on</span> <span class="n">data</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="n">using</span> <span class="n">lens</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">...</span><span class="n">minimal</span> <span class="n">number</span> <span class="n">of</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">hypercube</span> <span class="n">to</span> <span class="n">do</span> <span class="n">clustering</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">...</span><span class="n">create</span> <span class="mi">921</span> <span class="n">nodes</span><span class="o">.</span>
<span class="o">...</span><span class="n">calculate</span> <span class="n">projection</span> <span class="n">coordinates</span> <span class="n">of</span> <span class="n">nodes</span><span class="o">.</span>
<span class="o">...</span><span class="n">construct</span> <span class="n">a</span> <span class="n">TDA</span> <span class="n">graph</span><span class="o">.</span>
<span class="o">...</span><span class="n">create</span> <span class="mi">13279</span> <span class="n">edges</span><span class="o">.</span>
<span class="n">Finish</span> <span class="n">TDA</span> <span class="n">mapping</span>
</pre></div>
</div>
<iframe src="_static/comp2.html" height="500px" width="100%"></iframe><p>The resulted graph has 921 nodes and 13279 edges. Increasing number of components makes the graph more densely connected with more nodes. If we compare these two graphs visually, we could see that the general topological structure is similar. But the more <code class="docutils literal notranslate"><span class="pre">components</span></code> you used, the more complicated a graph will be generated. We recommend the default parameter <code class="docutils literal notranslate"><span class="pre">components=[0,1]</span></code> in most situations.</p>
</div>
<div class="section" id="selecting-resolution-and-overlap-in-cover">
<h2>Selecting <code class="docutils literal notranslate"><span class="pre">resolution</span></code> and <code class="docutils literal notranslate"><span class="pre">overlap</span></code> in <code class="docutils literal notranslate"><span class="pre">Cover</span></code><a class="headerlink" href="#selecting-resolution-and-overlap-in-cover" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Cover</span></code> class of <em>tmap</em> controls the resolution we want to study the underlying ‘data shape’, together with strength of continuity we want to keep on that ‘shape’. There are two parameters for this purpose: <cite>resolution</cite> decides how many intervals/bins you want to split the data into along each filter components, and <cite>overlap</cite> specifies the fraction of adjacent intervals need to be overlapped.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">resolution</span></code> parameter determines the number of hypercubes to calculate: <code class="docutils literal notranslate"><span class="pre">resolution</span> <span class="pre">**</span> <span class="pre">n_components</span></code>. Although increasing <cite>resolution</cite> can help to retain a fine-grain structure of the underlying ‘data shape’, it should be balanced with the number of samples in the analyzed dataset. Setting a <cite>resolution</cite> parameter too high will result in a ‘sparse’ TDA network, with many samples unclustered or ignored. In principle, if the dataset are densely sampled from a ‘hidden data shape’, higher <cite>resolution</cite> is better. Otherwise, <cite>resolution</cite> should be set up to have enough samples in each hypercube for downstream clustering analysis.</p>
<img alt="iris tmap resolution result" src="_images/resolution.png" />
<p>To demonstrate the effects, we increase <code class="docutils literal notranslate"><span class="pre">resolution</span></code> by 10 times and leave <code class="docutils literal notranslate"><span class="pre">overlap</span></code> unchanged. As shown above, high <code class="docutils literal notranslate"><span class="pre">resolution</span></code> for a small dataset will cause each hypercube has too few samples for clustering and no significant clusters can be detected. The resulting network will become sparse and fragmented. But using a very low <code class="docutils literal notranslate"><span class="pre">resolution</span></code> will generate a TDA graph too coarse to capture the true underlying ‘data shape’.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">overlap</span></code> parameter influences the edges between nodes in a TDA network. The larger the <code class="docutils literal notranslate"><span class="pre">overlap</span></code> you set, the more edges you will have between nodes, and therefore, a denser TDA network will be reconstructed. Too low <code class="docutils literal notranslate"><span class="pre">overlap</span></code> will eliminate most of the edges, and will result in many isolated nodes or network components.</p>
<img alt="iris tmap overlap result" src="_images/resolution2.png" />
<p>As we see above, <code class="docutils literal notranslate"><span class="pre">resolution</span></code> is an empirical parameter, which is depend on the size of your dataset. It should be carefully adjusted to reconstruct the underlying data shape properly. The larger the <code class="docutils literal notranslate"><span class="pre">overlap</span></code> you use, the more ‘continuity’ it will capture. Apart from the effects on general structure of a TDA network, these parameters also influence <strong>cover ratio</strong> of samples to be retained by clustering analysis, which will be discussed below.</p>
</div>
<div class="section" id="selecting-eps-and-min-samples-in-dbscan">
<h2>Selecting <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> in DBSCAN<a class="headerlink" href="#selecting-eps-and-min-samples-in-dbscan" title="Permalink to this headline">¶</a></h2>
<p><em>tmap</em> uses DBSCAN as the default cluster, which is a density-based clustering method, and has two primary parameters: <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code>. <code class="docutils literal notranslate"><span class="pre">eps</span></code> is the maximum distance between two samples for them to be considered as in the same neighborhood during clustering; and <cite>min_samples</cite> specifies how many neighbors a point should have to be considered as a ‘core point’ for cluster formation. These two parameters have great impacts on how many samples can be clustered into nodes, and how many samples will be shared between nodes to connect them with edges.</p>
<p>To aid in selecting a proper value of <code class="docutils literal notranslate"><span class="pre">eps</span></code>, we implemented <code class="docutils literal notranslate"><span class="pre">utils.optimize_dbscan_eps</span></code>, which can automatically determine the parameter from an input dataset. This function tries to estimate the distribution of neighborhoods from a dataset by calculating the distance to its nearest neighbor for each sample. Based on this distribution of nearest-neighbor distances, we can select a desired <code class="docutils literal notranslate"><span class="pre">eps</span></code> value for which we can cover/cluster the neighborhood for a specified <strong>percentage</strong> of samples, by passing a <code class="docutils literal notranslate"><span class="pre">threshold</span></code> (percentile value) to <code class="docutils literal notranslate"><span class="pre">optimize_dbscan_eps</span></code>.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> parameter, we may want to retain minor clusters using a small value, such as <code class="docutils literal notranslate"><span class="pre">min_samples=2</span></code>, or use a large value to keep large and robust clusters only. If we set <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> too large, we will only be able to see a ‘backbone’ of the ‘data shape’, and lose many samples that are scattered around. Therefore, large <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> is suitable for <strong>big</strong> dataset to capture its ‘backbone’ structure. But for small dataset, a small value will be more proper.</p>
</div>
<div class="section" id="optimization-of-a-cover-ratio-of-samples">
<h2>Optimization of a <em>cover ratio</em> of Samples<a class="headerlink" href="#optimization-of-a-cover-ratio-of-samples" title="Permalink to this headline">¶</a></h2>
<p>During the clustering process in <em>tmap</em>, unclustered samples will be discarded and not included in the final TDA network. Here we designate a <em>cover ratio</em> as a measure of how many samples (as percentage) are retained in a final <em>tmap</em> network. Cover ratio is influenced directly by the parameters of <code class="docutils literal notranslate"><span class="pre">resolution</span></code>, <code class="docutils literal notranslate"><span class="pre">overlap</span></code>, <code class="docutils literal notranslate"><span class="pre">eps</span></code> and <code class="docutils literal notranslate"><span class="pre">min_samples</span></code>. In practice, it may be unaffordable to lose too many samples, and we want to have a large cover ratio. Here we explore the relationship between <em>cover ratio</em> and some of the <em>tmap</em> parameters using a real FGFP microbiome dataset (see the <a class="reference internal" href="example.html"><span class="doc">‘Microbiome Examples’</span></a> for more details about this dataset).</p>
</div>
<div class="section" id="relationship-between-cover-ratio-and-tmap-parameters">
<h2>Relationship between <em>cover ratio</em> and <em>tmap</em> parameters<a class="headerlink" href="#relationship-between-cover-ratio-and-tmap-parameters" title="Permalink to this headline">¶</a></h2>
<p>The following figure shows how <em>cover ratio</em> changes along with different <em>tmap</em> parameters.</p>
<img alt="cover ratio" src="_images/fig1.png" />
<p>We summarize the effects of different parameters on <em>cover ratio</em> as in the following table, which can be used as a guidance for tuning parameters manually:</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">parameter</th>
<th class="head">relationship / effects</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">eps</span></code></td>
<td>larger value increases cover ratio</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">overlap</span></code></td>
<td>larger value increases cover ratio</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">resolution</span></code></td>
<td>larger value decreases cover ratio</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">min_samples</span></code></td>
<td>larger value decreases cover ratio</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vis.html" class="btn btn-neutral float-right" title="Visualizing and Exploring TDA Network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basic.html" class="btn btn-neutral" title="Basic Usage of tmap" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Tianhua Liao, YuChen Wei, Haokui Zhou.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>