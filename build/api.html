

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API &mdash; tmap 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference" href="reference.html" />
    <link rel="prev" title="Microbiome Examples" href="example.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> tmap
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic Usage of <em>tmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="param.html">How to Choose Parameters in <em>tmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="vis.html">Visualizing and Exploring TDA Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="statistical.html">Network Statistical Analysis in <em>tmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="how2work.html">How <em>tmap</em> work</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Microbiome Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tmap</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="tmap.tda.mapper.Mapper">
<em class="property">class </em><code class="descclassname">tmap.tda.mapper.</code><code class="descname">Mapper</code><span class="sig-paren">(</span><em>verbose=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/mapper.html#Mapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.mapper.Mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>implement the TDA mapper framework for microbiome analysis</p>
<dl class="method">
<dt id="tmap.tda.mapper.Mapper.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>data</em>, <em>lens=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/mapper.html#Mapper.filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.mapper.Mapper.filter" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>numpy.ndarray/pandas.DataFrame</em>) – </li>
<li><strong>lens</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of instance of class which is inherited from <code class="docutils literal notranslate"><span class="pre">tmap.tda.filter.Filter</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Input data may need to imputed for remove np.inf or np.nan, or it will raise error in fit step.
It is recommended to scale original data with MinMaxScalar to check the completeness of data.</p>
<p>Project/Filter high dimensional data points use the specified lens. If user provides multiple filters as input, it will
simply concatenate all output array along axis 1.</p>
<p>Finally, you will get a ndarray with <em>shape</em> (n_data,sum(n_components lens))</p>
</dd></dl>

<dl class="method">
<dt id="tmap.tda.mapper.Mapper.map">
<code class="descname">map</code><span class="sig-paren">(</span><em>data</em>, <em>cover</em>, <em>clusterer=DBSCAN(algorithm='auto'</em>, <em>eps=0.5</em>, <em>leaf_size=30</em>, <em>metric='euclidean'</em>, <em>metric_params=None</em>, <em>min_samples=1</em>, <em>n_jobs=None</em>, <em>p=None)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/mapper.html#Mapper.map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.mapper.Mapper.map" title="Permalink to this definition">¶</a></dt>
<dd><p>map the points cloud with the projection data, and return a TDA graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>numpy.ndarray/pandas.DataFrame</em>) – The row number of data must equal to the data you passed to <code class="docutils literal notranslate"><span class="pre">Cover</span></code></li>
<li><strong>Cover</strong> (<a class="reference internal" href="#tmap.tda.cover.Cover" title="tmap.tda.cover.Cover"><em>tmap.tda.cover.Cover</em></a>) – </li>
<li><strong>clusterer</strong> (<em>sklearn.cluster</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dictionary with multiple keys which described below.</p>
</td>
</tr>
</tbody>
</table>
<p>During the process, it will output progress information depending on <code class="docutils literal notranslate"><span class="pre">verbose</span></code></p>
<p>Basically, it will iterate all <em>hypercubes</em> which generated by <code class="docutils literal notranslate"><span class="pre">cover</span></code> and cluster samples within a <em>hypercubes</em> into several nodes with providing clusterer. It will drop unclassified samples out and keep samples which are clustered. The name of nodes are annotated by the counting number during iteration. Currently, it doesn’t accept any name behaviour for nodes.</p>
<p>The resulting graph is a dictionary containing multiple keys and corresponding values. For better understanding the meaning of all keys and values. Here is the descriptions of each key.</p>
<blockquote>
<div><ol class="arabic simple">
<li>nodes: Another dictionary for storge the mapping relationships between <em>nodes</em> and <em>samples</em>. Key is the name of nodes. Values is a list of corresponding index of samples.</li>
<li>edges: A list of 2-tuples for indicating edges between nodes.</li>
<li>adj_matrix: A square <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> constructed by nodes ID. The elements of the matrix indicate whether pairs of vertices are adjacent or not in the graph. (Unweighted)</li>
<li>sample_names: A list of samples names which assign from the index of providing <code class="docutils literal notranslate"><span class="pre">data</span></code>. If ‘index’ not in <code class="docutils literal notranslate"><span class="pre">dir(data)</span></code>, it will replace with a range of n_row of data.</li>
<li>node_keys: A list of ordered nodes ID.</li>
<li>node_positions: A dictionary with node as key and position of node as value. Depending on the shape of the cover.data, it will simply calculate the average values of all samples within a node in cover.data and assign it as the position info of the node.</li>
<li>node_sizes: A dictionary with node as key and number of samples within the node as value.</li>
<li>params: A dictionary for storing parameters of <code class="docutils literal notranslate"><span class="pre">cover</span></code> and <code class="docutils literal notranslate"><span class="pre">cluster</span></code></li>
</ol>
</div></blockquote>
<p>In future, structured class of graph will be implemented and taken as the result of <code class="docutils literal notranslate"><span class="pre">Mapper</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="tmap.tda.mapper.Mapper.verbose">
<code class="descname">verbose</code><em class="property"> = None</em><a class="headerlink" href="#tmap.tda.mapper.Mapper.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>if verbose greater than 1, it will output detail info.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tmap.tda.cover.Cover">
<em class="property">class </em><code class="descclassname">tmap.tda.cover.</code><code class="descname">Cover</code><span class="sig-paren">(</span><em>projected_data</em>, <em>resolution=10</em>, <em>overlap=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/cover.html#Cover"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.cover.Cover" title="Permalink to this definition">¶</a></dt>
<dd><p>Covering the projection data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>projected_data</strong> (<em>numpy.ndarray/pandas.DataFrame</em>) – Normally, <cite>projected_data</cite> should be the data transformed by <em>MDS</em> or <em>t-SNE</em> or <em>PCA</em>. It decides the way of partition for the original point cloud.</li>
<li><strong>resolution</strong> (<em>integer</em>) – It decides the number of partition of each axis at <code class="docutils literal notranslate"><span class="pre">projected_data</span></code></li>
<li><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – <cite>overlap</cite> must greater than 0. It decides the level of the expansion of each partition. If <cite>overlap</cite> equals to 0.5, each partition (include the first and the last) will expand 0.5 times of orginal.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tmap.tda.cover.Cover.hypercubes">
<code class="descname">hypercubes</code><a class="headerlink" href="#tmap.tda.cover.Cover.hypercubes" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate hypercubes (covering) using a generator function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">It returns a mask for the projected_data. Each row is a list of boolean for indicating which samples are within the current cube. The row number of hypercubes represents the number of partition.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tmap.tda.metric.Metric">
<em class="property">class </em><code class="descclassname">tmap.tda.metric.</code><code class="descname">Metric</code><span class="sig-paren">(</span><em>metric='euclidean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/metric.html#Metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.metric.Metric" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">+</span> <span class="pre">data</span> <span class="pre">-&gt;</span> <span class="pre">distance</span> <span class="pre">matrix</span></code></p>
<p>Define a distance metric and transform data points into a distance matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – <p><cite>metric</cite> specified a distance metric.
For example:</p>
<ul class="simple">
<li>cosine</li>
<li>euclidean</li>
<li>hamming</li>
<li>minkowski</li>
<li>precomputed:  for precomputed distance matrix.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tmap.tda.metric.Metric.fit_transform">
<code class="descname">fit_transform</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/metric.html#Metric.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.metric.Metric.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and return a distance matrix based on the specified metric.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>np.ndarray/pd.DataFrame</em>) – <cite>data</cite>: raw data or precomputed distance matrix.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tmap.tda.plot.Color">
<em class="property">class </em><code class="descclassname">tmap.tda.plot.</code><code class="descname">Color</code><span class="sig-paren">(</span><em>target</em>, <em>dtype='numerical'</em>, <em>target_by='sample'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/plot.html#Color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.plot.Color" title="Permalink to this definition">¶</a></dt>
<dd><p>map colors to target values for TDA network visualization</p>
<ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">target_by</span></code> set as <em>samples</em>, it means that it will pass original data instead of SAFE score for colorizing the node on the graph.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">node</span></code> set as <em>node</em>, it means that it will pass SAFE score for colorizing the node on the graph. So the target must be a dictionary generated by SAFE_batch function. If you using single SAFE function called <code class="docutils literal notranslate"><span class="pre">SAFE</span></code>, it will also create a dict which could be used.</li>
</ul>
<p>The basically code assign the highest values with red and the lowest values with blue. Before we assign the color, it will split the target into 4 parts with <code class="docutils literal notranslate"><span class="pre">np.percentile</span></code> and scale each part with different upper and lower boundary.</p>
<p>It is normally have 4 distinct parts in color bar but it will easily missing some parts due to some skewness which misleading the values of percentile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>target</strong> (<em>list/np.ndarray/pd.Series/dict</em>) – target values for samples or nodes</li>
<li><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – type of target values, “numerical” or “categorical”</li>
<li><strong>target_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – target type of “sample” or “node”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tmap.tda.plot.Color.get_colors">
<code class="descname">get_colors</code><span class="sig-paren">(</span><em>nodes</em>, <em>cmap=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/plot.html#Color.get_colors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.plot.Color.get_colors" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – nodes from graph</li>
<li><strong>cmap</strong> – not implemented yet…</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">nodes colors with keys, and the color map of the target values</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a> (first is a dict node_ID:node_color, second is a tuple (node_ID_index,node_color))</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tmap.tda.plot.Color.get_sample_colors">
<code class="descname">get_sample_colors</code><span class="sig-paren">(</span><em>cmap=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/plot.html#Color.get_sample_colors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.plot.Color.get_sample_colors" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – nodes from graph</li>
<li><strong>cmap</strong> – not implemented yet…</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">nodes colors with keys, and the color map of the target values</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a> (first is a dict node_ID:node_color, second is a tuple (node_ID_index,node_color))</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tmap.tda.plot.show">
<code class="descclassname">tmap.tda.plot.</code><code class="descname">show</code><span class="sig-paren">(</span><em>data</em>, <em>graph</em>, <em>color=None</em>, <em>fig_size=(10</em>, <em>10)</em>, <em>node_size=10</em>, <em>edge_width=2</em>, <em>mode=None</em>, <em>strength=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/plot.html#show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.plot.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Network visualization of TDA mapper</p>
<p>Using matplotlib as basic engine, it is easily add title or others elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>np.ndarray/pd.DataFrame</em>) – </li>
<li><strong>graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – </li>
<li><strong>color</strong> (<em>Color/str</em>) – Passing <code class="docutils literal notranslate"><span class="pre">tmap.tda.plot.Color</span></code> or just simply color string.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – height and width</li>
<li><strong>node_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – With given node_size, it will scale all nodes with same size <code class="docutils literal notranslate"><span class="pre">node_size/max(node_sizes)</span> <span class="pre">*</span> <span class="pre">node_size</span> <span class="pre">**2</span></code>. The size of nodes also depends on the biggest node which contains maxium number of samples.</li>
<li><strong>edge_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Line width of edges.</li>
<li><strong>mode</strong> (<em>str/None</em>) – Currently, Spring layout is the only one style supported.</li>
<li><strong>strength</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Optimal distance between nodes.  If None the distance is set to <code class="docutils literal notranslate"><span class="pre">1/sqrt(n)</span></code> where n is the number of nodes.  Increase this value to move nodes farther apart.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">plt.figure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tmap.tda.plot.vis_progressX">
<code class="descclassname">tmap.tda.plot.</code><code class="descname">vis_progressX</code><span class="sig-paren">(</span><em>graph</em>, <em>projected_X</em>, <em>simple=False</em>, <em>mode='file'</em>, <em>color=None</em>, <em>_color_SAFE=None</em>, <em>min_size=10</em>, <em>max_size=40</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/plot.html#vis_progressX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.plot.vis_progressX" title="Permalink to this definition">¶</a></dt>
<dd><p>For dynamic visualizing tmap construction process, it performs a interactive graph based on <cite>plotly</cite> with a slider to present the process from ordination to graph step by step. Currently, it doesn’t provide any API for overriding the number of step from ordination to graph. It may be implemented at the future.</p>
<p>If you want to draw a simple graph with edges and nodes instead of the process,  try the params <code class="docutils literal notranslate"><span class="pre">simple</span></code>.</p>
<p>This visualized function is mainly based on plotly which is a interactive Python graphing library. The params mode is trying to provide multiple type of return for different purpose. There are three different modes you can choose including “file” which return a html created by plotly, “obj” which return a reusable python dict object and “web” which normally used at notebook and make inline visualization possible.</p>
<p>The color part of this function has a little bit complex because of the multiple sub-figures. Currently, it use the <code class="docutils literal notranslate"><span class="pre">tmap.tda.plot.Color</span></code> class to auto generate color with given array. More detailed about how to auto generate color could be reviewed at the annotation of <code class="docutils literal notranslate"><span class="pre">tmap.tda.plot.Color</span></code>.</p>
<p>In this function,  there are two kinds of color need to implement.</p>
<blockquote>
<div><ul class="simple">
<li>First, all color and its showing text values of samples points should be followed by given color params. The color could be <strong>any array</strong> which represents some measurement of Nodes or Samples. <strong>It doesn’t have to be SAFE score</strong>.</li>
<li>Second, The <code class="docutils literal notranslate"><span class="pre">_color_SAFE</span></code> param should be a <code class="docutils literal notranslate"><span class="pre">Color</span></code> with a nodes-length array, which is normally a SAFE score.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>graph</strong> – </li>
<li><strong>projected_X</strong> (<em>np.array</em>) – </li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – [file|obj|web]</li>
<li><strong>simple</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </li>
<li><strong>color</strong> – </li>
<li><strong>_color_SAFE</strong> – </li>
<li><strong>kwargs</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tmap.netx.SAFE.SAFE_batch">
<code class="descclassname">tmap.netx.SAFE.</code><code class="descname">SAFE_batch</code><span class="sig-paren">(</span><em>graph</em>, <em>meta_data</em>, <em>n_iter=1000</em>, <em>nr_threshold=0.5</em>, <em>shuffle_obj='node'</em>, <em>_cal_type='auto'</em>, <em>_mode='enrich'</em>, <em>agg_mode='sum'</em>, <em>verbose=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/netx/SAFE.html#SAFE_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.netx.SAFE.SAFE_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Map sample meta-data to node associated values (using means),
and perform SAFE batch analysis for multiple features</p>
<p>For more information, you should see <a class="reference internal" href="how2work.html"><span class="doc">How tmap work</span></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – </li>
<li><strong>meta_data</strong> (<em>np.ndarry/pd.DataFrame</em>) – </li>
<li><strong>n_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Permutation times. For some features with skewness values, it should be higher in order to stabilize the resulting SAFE score.</li>
<li><strong>nr_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Float in range of [0,100]. The threshold is used to cut path distance with percentiles</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">return dict <code class="docutils literal notranslate"><span class="pre">{feature:</span> <span class="pre">{node_ID:p-values(fdr)}</span> <span class="pre">}</span></code> .</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tmap.netx.SAFE._SAFE">
<code class="descclassname">tmap.netx.SAFE.</code><code class="descname">_SAFE</code><span class="sig-paren">(</span><em>graph</em>, <em>node_data</em>, <em>n_iter=1000</em>, <em>nr_threshold=0.5</em>, <em>all_dist=None</em>, <em>neighborhoods=None</em>, <em>_cal_type='dict'</em>, <em>_mode='enrich'</em>, <em>agg_mode='sum'</em>, <em>verbose=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/netx/SAFE.html#_SAFE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.netx.SAFE._SAFE" title="Permalink to this definition">¶</a></dt>
<dd><p>perform SAFE analysis by node permutations
:param graph:
:param node_data: node associated values
:param n_iter: number of permutations
:param nr_threshold: Float in range of [0,100]. The threshold is used to cut path distance with percentiles for neighbour.
:param _cal_type: hidden parameters. For a big data with too many features(&gt;=100), calculation with pandas will faster than using dict.
:return: return dict with keys of nodes ID, values are normalized and multi-test corrected p values.</p>
</dd></dl>

<dl class="function">
<dt id="tmap.netx.coenrichment_analysis.pairwise_coenrichment">
<code class="descclassname">tmap.netx.coenrichment_analysis.</code><code class="descname">pairwise_coenrichment</code><span class="sig-paren">(</span><em>graph</em>, <em>safe_scores</em>, <em>n_iter=5000</em>, <em>p_value=0.05</em>, <em>_pre_cal_enriched=None</em>, <em>verbose=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/netx/coenrichment_analysis.html#pairwise_coenrichment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.netx.coenrichment_analysis.pairwise_coenrichment" title="Permalink to this definition">¶</a></dt>
<dd><p>Pair-wise calculation for co-enrichment of each feature found at safe_scores.
If _pre_cal_enriched was given, n_iter and p_value is not useless.
Or you should modify n_iter and p_value to fit the params you passed to <code class="docutils literal notranslate"><span class="pre">SAFE</span></code> algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>graph</strong> – </li>
<li><strong>safe_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – A SAFE score output from <code class="docutils literal notranslate"><span class="pre">SAFE_batch</span></code> which must contain all values occur at fea.</li>
<li><strong>n_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Permutation times used at <code class="docutils literal notranslate"><span class="pre">SAFE_batch</span></code>.</li>
<li><strong>p_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The p-value to determine the enriched nodes.</li>
<li><strong>_pre_cal_enriched</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – A pre calculated enriched_centroid which comprised all necessary features will save time.</li>
<li><strong>verbose</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tmap.netx.coenrichment_analysis.coenrichment_for_nodes">
<code class="descclassname">tmap.netx.coenrichment_analysis.</code><code class="descname">coenrichment_for_nodes</code><span class="sig-paren">(</span><em>graph</em>, <em>nodes</em>, <em>fea</em>, <em>enriched_centroid</em>, <em>threshold=None</em>, <em>safe_scores=None</em>, <em>_filter=True</em>, <em>mode='both'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/netx/coenrichment_analysis.html#coenrichment_for_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.netx.coenrichment_analysis.coenrichment_for_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Coenrichment main function
With given feature and its enriched nodes, we could construct a contingency table when we comparing to other feature and its enriched nodes.
For statistical test association between different features, fisher-exact test was applied to each constructed contingency table. Fisher-exact test only consider the association between two classifications instead of the ratio. For coenrichment, we also implement a accessory function called <code class="docutils literal notranslate"><span class="pre">is_enriched</span></code> to further judge that if the ratio of enrichment is bigger than the non-enrichement.</p>
<p>Besides the global co-enrichment, several local enrichment were observed. With <code class="docutils literal notranslate"><span class="pre">networkx</span></code> algorithm for finding component, we could extract each local enrichment nodes from global enrichment.</p>
<p>Because of the complex combination between comparison of local enrichment, two different contingency table was constructed.</p>
<p>The contingency table which compare different enriched nodes among components and enriched or non-enriched nodes of other features shown below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="37%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">fea</th>
<th class="head">fea this comp enriched nodes</th>
<th class="head">fea other comp enriched nodes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>o_f_enriched_nodes</td>
<td>s1</td>
<td>s2</td>
</tr>
<tr class="row-odd"><td>o_f_non-enriched_nodes</td>
<td>s3</td>
<td>s4</td>
</tr>
</tbody>
</table>
<p>The other contingency table which compare enriched nodes within specific component or non-enriched nodes and enriched or non-enriched nodes of other features shown below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="37%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">fea</th>
<th class="head">fea this comp enriched nodes</th>
<th class="head">fea non-enriched nodes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>o_f_enriched_nodes</td>
<td>s1</td>
<td>s2</td>
</tr>
<tr class="row-odd"><td>o_f_non-enriched_nodes</td>
<td>s3</td>
<td>s4</td>
</tr>
</tbody>
</table>
<p>For convenient calculation, three different mode [both|global|local] could be choose.</p>
<p>Output objects contain two different kinds of dictionary. One dict is recording the correlation information between different features, the other is recording the raw contingency table info between each comparsion which is a list of nodes representing s1,s2,s3,s4.</p>
<p>If mode equals to ‘both’, it will output global correlative dict, local correlative, metainfo.
If mode equals to ‘global’, it will output local correlative, metainfo.
If mode equals to ‘local’, it will output global correlative dict, metainfo.</p>
<p>For global correlative, keys are compared features and values are tuples (oddsratio, pvalue) from fisher-exact test.
For local correlative, keys are tuples of (index of components, size of components, features) and values are as same as global correlative.
The remaining metainfo is a dictionary shared same key to global/local correlative but contains contingency table info.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>graph</strong> – tmap constructed graph</li>
<li><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – a list of nodes you want to process from specific feature</li>
<li><strong>fea</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – feature name which doesn’t need to exist at enriched_centroid</li>
<li><strong>enriched_centroid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – enriched_centroide output from <code class="docutils literal notranslate"><span class="pre">get_enriched_nodes</span></code></li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – None or a threshold for SAFE score. If it is a None, it will not filter the nodes.</li>
<li><strong>safe_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – A dictionary which store SAFE_scores for filter the nodes. If you want to filter the nodes, it must simultaneously give safe_scores and threshold.</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – [both|global|local]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tmap.tda.utils.output_graph">
<code class="descclassname">tmap.tda.utils.</code><code class="descname">output_graph</code><span class="sig-paren">(</span><em>graph</em>, <em>filepath</em>, <em>sep='\t'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/utils.html#output_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.utils.output_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Export graph as a file with sep. The output file should be used with <a class="reference external" href="http://cytoscape.org/">Cytoscape</a> .</p>
<p>It should be noticed that it will overwrite the file you provided.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – Graph output from tda.mapper.map</li>
<li><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – </li>
<li><strong>sep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tmap.tda.utils.output_Node_data">
<code class="descclassname">tmap.tda.utils.</code><code class="descname">output_Node_data</code><span class="sig-paren">(</span><em>graph</em>, <em>filepath</em>, <em>data</em>, <em>features=None</em>, <em>sep='\t'</em>, <em>target_by='sample'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/utils.html#output_Node_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.utils.output_Node_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Export Node data with provided filepath. The output file should be used with <a class="reference external" href="http://cytoscape.org/">Cytoscape</a> .</p>
<p>It should be noticed that it will overwrite the file you provided.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – </li>
<li><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – </li>
<li><strong>data</strong> (<em>np.ndarray/pandas.Dataframe</em>) – with shape [n_samples,n_features] or [n_nodes,n_features]</li>
<li><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – It could be None and it will use count number as feature names.</li>
<li><strong>sep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – </li>
<li><strong>target_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – target type of “sample” or “node”</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tmap.tda.utils.output_Edge_data">
<code class="descclassname">tmap.tda.utils.</code><code class="descname">output_Edge_data</code><span class="sig-paren">(</span><em>graph</em>, <em>filepath</em>, <em>sep='\t'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tmap/tda/utils.html#output_Edge_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tmap.tda.utils.output_Edge_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Export edge data with sep [default=TAB]</p>
<p>Mainly for the result of tmap.tda.netx.coenrich</p>
<p>The output file should be used with <a class="reference external" href="http://cytoscape.org/">Cytoscape</a> .</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – graph output by netx.coenrich</li>
<li><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – </li>
<li><strong>sep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reference.html" class="btn btn-neutral float-right" title="Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="example.html" class="btn btn-neutral" title="Microbiome Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Tianhua Liao, YuChen Wei, Haokui Zhou.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>