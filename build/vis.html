

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Visualizing and Exploring TDA Network &mdash; tmap 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Network Statistical Analysis in tmap" href="statistical.html" />
    <link rel="prev" title="How to Choose Parameters in tmap" href="param.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> tmap
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic Usage of <em>tmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="param.html">How to Choose Parameters in <em>tmap</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Visualizing and Exploring TDA Network</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#network-plotting-without-a-target-variable">Network Plotting Without a Target Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-plotting-with-a-target-variable">Network Plotting With a Target Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-construction-process-visualization">Network Construction process visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="statistical.html">Network Statistical Analysis in <em>tmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="how2work.html">How <em>tmap</em> work</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Microbiome Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tmap</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Visualizing and Exploring TDA Network</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/vis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="visualizing-and-exploring-tda-network">
<h1>Visualizing and Exploring TDA Network<a class="headerlink" href="#visualizing-and-exploring-tda-network" title="Permalink to this headline">¶</a></h1>
<p>A TDA network is a powerful and compressive representation of a high dimensional complex dataset. Plotting the network provides a direct and insightful visualization of the underlying ‘data shape’, which can help to explore hidden patterns of the data. Nodes in the network correspond to groups of similar samples that have been clustered together. An edge between two nodes means that there are shared/common samples between the two nodes. Both large scale global structure and local group of nodes can be revealed in the network.</p>
<p>Furthermore, mapping a specified target variable onto the network, using a color scheme, can show how the target variable change along with the network. Therefore, plotting a TDA network and coloring the network with interested target variables is the first step to understand the analyzed data. In <em>tmap</em>, we can use the <cite>Color</cite> class to make a color scheme for a target variable. Then we can use the <cite>show</cite> function from <cite>tda.plot</cite> to visualize a TDA network, as demonstrated in the following codes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>
<span class="kn">from</span> <span class="nn">tmap.tda</span> <span class="kn">import</span> <span class="n">mapper</span><span class="p">,</span> <span class="nb">filter</span>
<span class="kn">from</span> <span class="nn">tmap.tda.cover</span> <span class="kn">import</span> <span class="n">Cover</span>
<span class="kn">from</span> <span class="nn">tmap.tda.plot</span> <span class="kn">import</span> <span class="n">show</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span><span class="n">tm_plot</span><span class="p">,</span><span class="n">vis_progressX</span>


<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># Step1. initiate a Mapper</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">Mapper</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Step2. Projection</span>
<span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">filter</span><span class="o">.</span><span class="n">MDS</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span><span class="n">random_state</span><span class="o">=</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">projected_X</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">lens</span><span class="o">=</span><span class="n">lens</span><span class="p">)</span>
<span class="n">projected_X</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">projected_X</span><span class="p">)</span>

<span class="c1"># Step3. Covering, clustering &amp; mapping</span>
<span class="n">clusterer</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cover</span> <span class="o">=</span> <span class="n">Cover</span><span class="p">(</span><span class="n">projected_data</span><span class="o">=</span><span class="n">MinMaxScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">projected_X</span><span class="p">),</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">cover</span><span class="o">=</span><span class="n">cover</span><span class="p">,</span> <span class="n">clusterer</span><span class="o">=</span><span class="n">clusterer</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="network-plotting-without-a-target-variable">
<h2>Network Plotting Without a Target Variable<a class="headerlink" href="#network-plotting-without-a-target-variable" title="Permalink to this headline">¶</a></h2>
<p>If we don’t have a target variable, we could simply use <cite>show</cite> to visualize the network without any specified color map. The <code class="docutils literal notranslate"><span class="pre">show</span></code> function was implement with the <strong>spring layout</strong> of <a class="reference external" href="https://networkx.github.io/">networkx</a>. After the version change into 2.+, it becomes weird. So we also implement a function called <code class="docutils literal notranslate"><span class="pre">vis_progressX</span></code> and simple api called <code class="docutils literal notranslate"><span class="pre">tm_plot</span></code>, both functions are based on <a class="reference external" href="https://plot.ly/python/">plotly</a>. .</p>
<p>By default, the network assigns all nodes with a default color of <strong>red</strong>. More flexible color is implemented inside a class called <code class="docutils literal notranslate"><span class="pre">Color</span></code> and it need a suitable target value and corresponding parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mf">0.17</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot network default" class="align-center" src="_images/vis_1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tm_plot</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">projected_X</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;_static/vis_1.html&#39;</span><span class="p">)</span>
<span class="c1"># equal to</span>
<span class="c1"># vis_progressX(graph,X,simple=True,mode=&#39;file&#39;,filename=&#39;_static/vis_1.html&#39;,include_plotlyjs=&#39;cdn&#39;)</span>
</pre></div>
</div>
<iframe src="_static/vis_1.html" height="500px" width="100%"></iframe></div>
<div class="section" id="network-plotting-with-a-target-variable">
<h2>Network Plotting With a Target Variable<a class="headerlink" href="#network-plotting-with-a-target-variable" title="Permalink to this headline">¶</a></h2>
<p>Plotting a TDA network with a target variable is very helpful to understand how the variable changes along the network and how it distinguishes between nodes. We can first make a color map for a chosen target variable, and then pass it together with a TDA graph to the <cite>show</cite> function for network plotting.</p>
<p>The following codes use a “categorical” color type for a categorical variable, such as different classes of samples. With a “categorical” color type, a node is assigned a color according to its most common class of its samples.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;categorical&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot network with a target 1" class="align-center" src="_images/vis_2.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;categorical&quot;</span><span class="p">)</span>
<span class="n">tm_plot</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">projected_X</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;_static/vis_2.html&#39;</span><span class="p">)</span>
<span class="c1"># equal to</span>
<span class="c1"># vis_progressX(graph,X,simple=True,color=color,mode=&#39;file&#39;,filename=&#39;_static/vis_1.html&#39;,include_plotlyjs=&#39;cdn&#39;)</span>
</pre></div>
</div>
<iframe src="_static/vis_2.html" height="500px" width="100%"></iframe><p>For a continuous target variable, we can use the “numerical” color type to make a color map. In this scenario, a node is assigned a color according to the mean values of its samples.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;numerical&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mf">0.19</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot network with a target 2" class="align-center" src="_images/vis_3.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;numerical&quot;</span><span class="p">)</span>
<span class="n">tm_plot</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">projected_X</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;_static/vis_3.html&#39;</span><span class="p">)</span>
<span class="c1"># equal to</span>
<span class="c1"># vis_progressX(graph,X,simple=True,color=color,mode=&#39;file&#39;,filename=&#39;_static/vis_1.html&#39;,include_plotlyjs=&#39;cdn&#39;)</span>
</pre></div>
</div>
<iframe src="_static/vis_3.html" height="500px" width="100%"></iframe></div>
<div class="section" id="network-construction-process-visualization">
<h2>Network Construction process visualization<a class="headerlink" href="#network-construction-process-visualization" title="Permalink to this headline">¶</a></h2>
<p>tmap is a bioinformatic pipeline of topological data analysis (TDA). So how the pipeline generate a network based on an ordination plot. <code class="docutils literal notranslate"><span class="pre">vis_progressX</span></code> is mainly focus on this effort and other plot is some by-products.</p>
<p>For visualizing the dynamic process before and after the network construction, we mainly plot the process with the help of <a class="reference external" href="https://plot.ly/python/">plotly</a>. .</p>
<p>Here is some basic example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;numerical&quot;</span><span class="p">)</span>
<span class="n">vis_progressX</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">projected_X</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;_static/vis_process.html&#39;</span><span class="p">,</span><span class="n">include_plotlyjs</span><span class="o">=</span><span class="s1">&#39;cdn&#39;</span><span class="p">)</span>
<span class="c1"># there are three kinds of mode at vis_progressX, you could also use &#39;obj&#39; to capture the ``Figure`` object and custom the layout.</span>
<span class="c1"># obj = vis_progressX(graph,projected_X,mode=&#39;obj&#39;,color=color)</span>
<span class="c1"># obj.layout = None</span>
<span class="c1"># plotly.offline.plot(obj)</span>
</pre></div>
</div>
<iframe src="_static/vis_process.html" height="700px" width="100%"></iframe><p>There a three subplot and a slider in the result html. The below slider could control the binning process which was divided into <strong>n_step [5]</strong> at the left figure. The upper right figure is showing the origin figure after ordination or the coordinates you passed called <strong>projected_X</strong>. The down right figure is showing the network and its color in final.</p>
<p>To go beyond network plotting and exploratory analysis, we can perform network-based statistical and enrichment analysis, which are demonstrated and explained in <a class="reference internal" href="statistical.html"><span class="doc">‘Network Statistical Analysis’</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="statistical.html" class="btn btn-neutral float-right" title="Network Statistical Analysis in tmap" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="param.html" class="btn btn-neutral" title="How to Choose Parameters in tmap" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Tianhua Liao, YuChen Wei, Haokui Zhou.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>